(function(e){function t(t){for(var o,r,a=t[0],s=t[1],u=t[2],d=0,p=[];d<a.length;d++)r=a[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&p.push(i[r][0]),i[r]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);l&&l(t);while(p.length)p.shift()();return c.push.apply(c,u||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],o=!0,a=1;a<n.length;a++){var s=n[a];0!==i[s]&&(o=!1)}o&&(c.splice(t--,1),e=r(r.s=n[0]))}return e}var o={},i={app:0},c=[];function r(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/thething-frontend-build/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],s=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var l=s;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},4473:function(e,t,n){},"4fdd":function(e,t,n){"use strict";n("dd8b")},5356:function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23"),i=(n("b0c0"),{class:"peer"}),c={class:"right",id:"right"},r={key:0,class:"view login"},a={class:"form-inner"},s=Object(o["createVNode"])("h1",null,"Login to Thething",-1),u=Object(o["createVNode"])("label",{for:"username"},"Username",-1),l=Object(o["createVNode"])("input",{type:"submit",value:"Login"},null,-1),d={key:1,class:"view chat"},p={class:"chat-box"},m={class:"message-inner"},f={class:"username"},h={class:"content"},b=Object(o["createVNode"])("input",{type:"submit",value:"Send"},null,-1);function v(e,t,n,v,_,g){var O=Object(o["resolveComponent"])("peercomp"),j=Object(o["resolveComponent"])("pane"),k=Object(o["resolveComponent"])("peerconn"),C=Object(o["resolveComponent"])("splitpanes"),y=Object(o["resolveComponent"])("peerconnSec");return Object(o["openBlock"])(),Object(o["createBlock"])(o["Fragment"],null,[Object(o["createVNode"])(C,{class:"default-theme"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(j,{size:_.left_size,"min-size":"0",id:"left_pane"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])("div",i,[""!==v.state.username&&null!==v.state.username?Object(o["withDirectives"])((Object(o["openBlock"])(),Object(o["createBlock"])(O,{key:0,ref:"peercomp_child_ref",state:v.state,onPeerMenu_exit:g.peerMenu_exit,onPeerMenu_startConn:g.peerConn_open,onPeerMenu_startConn_group:g.peerConn_open_group},null,8,["state","onPeerMenu_exit","onPeerMenu_startConn","onPeerMenu_startConn_group"])),[[o["vShow"],v.state.peer_on]]):Object(o["createCommentVNode"])("",!0)])]})),_:1},8,["size"]),Object(o["createVNode"])(j,{size:_.mid_size,"min-size":"0",id:"mid_pane"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])(C,{style:{height:"100vh"},class:"default-theme",horizontal:""},{default:Object(o["withCtx"])((function(){return[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(_.active_peers,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])(j,{class:"peer",key:e.name,id:e.name},{default:Object(o["withCtx"])((function(){return[""!==v.state.username&&null!==v.state.username?Object(o["withDirectives"])((Object(o["openBlock"])(),Object(o["createBlock"])(k,{key:0,ref:e.name,id:e.name,state:v.state,peer_info:e,onPeerConn_exit:g.peerConn_exit,onEmit_to_branch:g.emit_to_branch,onPeerConn_newMsg:g.peerConn_newMsg},null,8,["id","state","peer_info","onPeerConn_exit","onEmit_to_branch","onPeerConn_newMsg"])),[[o["vShow"],e.active]]):Object(o["createCommentVNode"])("",!0)]})),_:2},1032,["id"])})),128))]})),_:1})]})),_:1},8,["size"]),Object(o["createVNode"])(j,{id:"right_pane",size:100-_.left_size-_.mid_size,"min-size":"35"},{default:Object(o["withCtx"])((function(){return[Object(o["createVNode"])("div",c,[""===v.state.username||null===v.state.username?(Object(o["openBlock"])(),Object(o["createBlock"])("div",r,[Object(o["createVNode"])("form",{class:"login-form",onSubmit:t[2]||(t[2]=Object(o["withModifiers"])((function(){return v.Login&&v.Login.apply(v,arguments)}),["prevent"]))},[Object(o["createVNode"])("div",a,[s,u,Object(o["withDirectives"])(Object(o["createVNode"])("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=function(e){return v.inputUsername=e}),placeholder:"Please enter your username..."},null,512),[[o["vModelText"],v.inputUsername]]),l])],32)])):(Object(o["openBlock"])(),Object(o["createBlock"])("div",d,[Object(o["createVNode"])("header",null,[Object(o["withDirectives"])(Object(o["createVNode"])("button",{class:"peerMenu_open",onClick:t[3]||(t[3]=function(){return g.peerMenu_open&&g.peerMenu_open.apply(g,arguments)})},"Peer Menu",512),[[o["vShow"],!v.state.peer_on]]),Object(o["createVNode"])("button",{class:"logout",onClick:t[4]||(t[4]=function(){return g.Logout&&g.Logout.apply(g,arguments)})},"Logout"),Object(o["createVNode"])("h1",null,"Welcome to the lobby, "+Object(o["toDisplayString"])(v.state.username)+".",1)]),Object(o["createVNode"])("section",p,[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(v.state.messages,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])("div",{key:e.key,class:e.username==v.state.username?"message current-user":"message"},[Object(o["createVNode"])("div",m,[Object(o["createVNode"])("div",f,Object(o["toDisplayString"])(e.username),1),Object(o["createVNode"])("div",h,Object(o["toDisplayString"])(e.content),1)])],2)})),128))]),Object(o["createVNode"])("footer",null,[Object(o["createVNode"])("form",{onSubmit:t[6]||(t[6]=Object(o["withModifiers"])((function(){return v.SendMessage&&v.SendMessage.apply(v,arguments)}),["prevent"]))},[Object(o["withDirectives"])(Object(o["createVNode"])("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=function(e){return v.inputMessage=e}),placeholder:"Write a message..."},null,512),[[o["vModelText"],v.inputMessage]]),b],32)])]))])]})),_:1},8,["size"])]})),_:1}),(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(_.active_peers_group,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])("div",{key:e.name,id:e.name},[""!==v.state.username&&null!==v.state.username?Object(o["withDirectives"])((Object(o["openBlock"])(),Object(o["createBlock"])(y,{key:0,ref:"sec",id:e.name,state:v.state,peer_info:e,onPeerConn_exit:g.peerConn_exit,onEmit_to_group:g.emit_to_group,onPeerConn_newMsg:g.peerConn_newMsg},null,8,["id","state","peer_info","onPeerConn_exit","onEmit_to_group","onPeerConn_newMsg"])),[[o["vShow"],e.active]]):Object(o["createCommentVNode"])("",!0)],8,["id"])})),128))],64)}n("a15b"),n("159b"),n("b64b");var _=n("512e"),g=(n("c1ea"),n("260b")),O=(n("66ce"),{apiKey:"AIzaSyC1wuDVw3r3hira1fEK3nYCbX6nu66bfqg",authDomain:"thething-98c2d.firebaseapp.com",projectId:"thething-98c2d",storageBucket:"thething-98c2d.appspot.com",messagingSenderId:"835718742144",appId:"1:835718742144:web:9809226ab6c8ba3cdee665"}),j=g["a"].initializeApp(O),k=j,C=Object(o["withScopeId"])("data-v-3dd9f408");Object(o["pushScopeId"])("data-v-3dd9f408");var y={class:"view peercomp"},B=Object(o["createVNode"])("br",null,null,-1),M={key:0},S={key:1},V={class:"chat-box"},w={class:"message"},N={class:"message-inner"},I=Object(o["createVNode"])("div",{class:"username"}," Active users: ",-1),x={class:"content userlist"},E=Object(o["createVNode"])("br",null,null,-1),T={class:"message-inner"},P={class:"username"},D={class:"message-inner"},z={class:"username"},H={class:"message-inner"},L={class:"username"},U={id:"group_select"},$=Object(o["createVNode"])("input",{type:"submit",value:"Send"},null,-1);Object(o["popScopeId"])();var F=C((function(e,t,n,i,c,r){return Object(o["openBlock"])(),Object(o["createBlock"])("div",y,[Object(o["createVNode"])("header",null,[Object(o["createVNode"])("h1",null,[Object(o["createTextVNode"])("Your Peer Service, "+Object(o["toDisplayString"])(n.state.username)+". ",1),B,c.peerState.id?(Object(o["openBlock"])(),Object(o["createBlock"])("span",M,"Your peerID: "+Object(o["toDisplayString"])(c.peerState.id),1)):(Object(o["openBlock"])(),Object(o["createBlock"])("span",S,"Connect to enable Peer Service.")),Object(o["createVNode"])("button",{onClick:t[1]||(t[1]=function(){return r.peerMenu_exit&&r.peerMenu_exit.apply(r,arguments)}),id:"back"},"Hide Peer Service")])]),Object(o["createVNode"])("section",V,[Object(o["createVNode"])("div",w,[Object(o["createVNode"])("div",N,[I,Object(o["createVNode"])("div",x,[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(n.state.userlist,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])("span",{key:e,onClick:function(t){return r.peerConn_clickUser(e.username)}},[Object(o["createTextVNode"])(Object(o["toDisplayString"])(e.username),1),E],8,["onClick"])})),128))])])]),(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(c.messages,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])("div",{key:e.key,class:e.username==n.state.username?"message current-user":"message"},[Object(o["createVNode"])("div",T,[Object(o["createVNode"])("div",P,Object(o["toDisplayString"])(e.username),1),Object(o["createVNode"])("div",{class:"content",onClick:function(t){return r.peerConn_confirmInvite(e)}},Object(o["toDisplayString"])(e.content),9,["onClick"])])],2)})),128)),(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(c.confMessages,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])("div",{key:e.key,class:e.username==n.state.username?"message current-user":"message"},[Object(o["createVNode"])("div",D,[Object(o["createVNode"])("div",z,Object(o["toDisplayString"])(e.username),1),Object(o["createVNode"])("div",{class:"content confContent",onClick:function(t){return r.peerConn_start(e.confirm_id,e.username)}},Object(o["toDisplayString"])(e.content),9,["onClick"])])],2)})),128)),(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(c.confMessages_group,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])("div",{key:e.key,class:e.username==n.state.username?"message current-user":"message"},[Object(o["createVNode"])("div",H,[Object(o["createVNode"])("div",L,Object(o["toDisplayString"])(e.username),1),Object(o["createVNode"])("div",{class:"content confContent",onClick:function(t){return r.peerConn_start_group(e.confirm_id,e.username,e.sender_name)}},Object(o["toDisplayString"])(e.content),9,["onClick"])])],2)})),128))]),Object(o["createVNode"])("footer",null,[c.peerState.id?(Object(o["openBlock"])(),Object(o["createBlock"])("button",{key:1,onClick:t[3]||(t[3]=function(){return r.peerConn_disconnect&&r.peerConn_disconnect.apply(r,arguments)}),id:"disconnect"},"Disconnect from the Peer Service")):(Object(o["openBlock"])(),Object(o["createBlock"])("button",{key:0,onClick:t[2]||(t[2]=function(){return r.peerConn_init&&r.peerConn_init.apply(r,arguments)}),id:"ready"},"Connect to Peer Service")),c.peerState.id?(Object(o["openBlock"])(),Object(o["createBlock"])("form",{key:2,onSubmit:t[5]||(t[5]=Object(o["withModifiers"])((function(){return r.peerConn_invite&&r.peerConn_invite.apply(r,arguments)}),["prevent"]))},[Object(o["withDirectives"])(Object(o["createVNode"])("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=function(e){return c.inputInvitation=e}),placeholder:"Enter a username to send an invitation..."},null,512),[[o["vModelText"],c.inputInvitation]]),Object(o["createVNode"])("select",U,[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(c.active_peers,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])("option",{value:e.group_n,key:e},Object(o["toDisplayString"])(e.names.join(",")),9,["value"])})),128))]),$],32)):Object(o["createCommentVNode"])("",!0)])])})),A=(n("caad"),n("2532"),n("a0bc")),W=n.n(A),K=n("bc3a").default,R={name:"peercomp",props:{state:{}},methods:{peerConn_init:function(){this.peerState.me=new W.a({host:"the0thing.herokuapp.com",path:"/peerjs/broker",port:80,config:{iceServers:[{url:"stun:global.stun.twilio.com:3478?transport=udp",urls:"stun:global.stun.twilio.com:3478?transport=udp"},{url:"turn:global.turn.twilio.com:3478?transport=udp",username:"aead563a3f21314845e336c9a9301dd4576d48956c075cdf09f723679001e464",urls:"turn:global.turn.twilio.com:3478?transport=udp",credential:"Aif90NIKOSofnkKChbTGFDv5/o+CwoUsphz4y2+MHXw="},{url:"turn:global.turn.twilio.com:3478?transport=tcp",username:"aead563a3f21314845e336c9a9301dd4576d48956c075cdf09f723679001e464",urls:"turn:global.turn.twilio.com:3478?transport=tcp",credential:"Aif90NIKOSofnkKChbTGFDv5/o+CwoUsphz4y2+MHXw="},{url:"turn:global.turn.twilio.com:443?transport=tcp",username:"aead563a3f21314845e336c9a9301dd4576d48956c075cdf09f723679001e464",urls:"turn:global.turn.twilio.com:443?transport=tcp",credential:"Aif90NIKOSofnkKChbTGFDv5/o+CwoUsphz4y2+MHXw="}],sdpSemantics:"unified-plan"}});var e=this.peerState;this.peerState.me.on("open",(function(t){e.id=t})),this.peerConn_checkInvite(),this.peerConn_checkConfInvite()},peerMenu_exit:function(){this.$emit("peerMenu_exit")},peerConn_disconnect:function(){this.peerState.id="",this.peerState.me=""},peerConn_invite:function(){if(""!=this.inputInvitation)if(0==document.getElementById("group_select").value){var e={target_name:this.inputInvitation,self_name:[this.state.username],self_id:this.peerState.id};this.inputInvitation="",K.post(this.PEERHOST+"/invite",e)}else{for(var t=[],n=0;n<this.active_peers.length;n++)if(document.getElementById("group_select").value==this.active_peers[n].group_n&&(t=this.active_peers[n].names,this.active_peers[n].names.includes(this.inputInvitation)))return;t.push(this.state.username),this.$root.$refs[t[0]].inputMessage="I have invited "+this.inputInvitation+" to join our chat.",this.$root.$refs[t[0]].SendMessage();var o={target_name:this.inputInvitation,self_name:t,self_id:this.peerState.id};this.inputInvitation="",K.post(this.PEERHOST+"/invite",o)}},peerConn_checkInvite:function(){var e=this.messages,t=this.state;K.post(this.PEERHOST+"/checkInvite",{self_name:this.state.username}).then((function(n){for(var o=n.data,i=0;i<o.length;i++){for(var c=!0,r=0;r<e.length;r++)o[i].self_name.join(", ")==e[r].username&&(c=!1);c&&o[i].self_name!=t.username&&e.push({username:o[i].self_name.join(", "),sender_name:o[i].self_name,sender_id:o[i].self_id,content:o[i].self_name+" has sent you an invitation. Click to initiate a private connection."})}})),setTimeout(this.peerConn_checkInvite,5e3)},peerConn_confirmInvite:function(e){var t={sender_id:e.sender_id,sender_name:e.sender_name,confirm_id:this.peerState.id,confirm_name:this.state.username};K.post(this.PEERHOST+"/confirmInvite",t),this.peerConn_start(e.sender_id,e.username)},peerConn_checkConfInvite:function(){var e=this.confMessages,t=this.confMessages_group,n=this.state;K.post(this.PEERHOST+"/checkConfInvite",{self_name:this.state.username}).then((function(o){for(var i=o.data,c=0;c<i.length;c++){for(var r=!0,a=0;a<e.length;a++)i[c].confirm_name==e[a].username&&(r=!1);for(var s=0;s<t.length;s++)i[c].confirm_name==t[s].username&&(r=!1);r&&i[c].confirm_name!=n.username&&(i[c].sender_name.length>1?t.push({sender_name:i[c].sender_name,username:i[c].confirm_name,confirm_id:i[c].confirm_id,content:i[c].confirm_name+" has accepted your invitation. Click to admit "+i[c].confirm_name+" into the chat."}):e.push({username:i[c].confirm_name,confirm_id:i[c].confirm_id,content:i[c].confirm_name+" has accepted your invitation. Click to enter a private connection."}))}})),setTimeout(this.peerConn_checkConfInvite,5e3)},peerConn_start:function(e,t){console.log(e);var n=this.peerState.me;this.peerMenu_exit(),this.active_peers.push({names:[t],group_n:this.active_peers[this.active_peers.length-1].group_n+1}),this.$emit("peerMenu_startConn",{id:e,name:t,me:n,active:!0})},peerConn_start_group:function(e,t,n){var o=this.peerState.me;this.peerMenu_exit(),this.$emit("peerMenu_startConn_group",{id:e,name:t,me:o,active:!0,sender_name:n})},peerConn_clickUser:function(e){e!=this.state.username&&(this.peerState.id||this.peerConn_init(),this.inputInvitation=e)}},data:function(){return{PEERHOST:"http://the0thing.herokuapp.com:80",peerState:{id:"",me:""},inputInvitation:"",messages:[],confMessages:[],confMessages_group:[],active_peers:[{group_n:0,names:["New Conversation"]}]}}};n("4fdd");R.render=F,R.__scopeId="data-v-3dd9f408";var q=R,X=Object(o["withScopeId"])("data-v-a36c8be4");Object(o["pushScopeId"])("data-v-a36c8be4");var Y={class:"view peerconn",id:"peerconn"},G=Object(o["createTextVNode"])("Your Peer Connection. "),J=Object(o["createVNode"])("br",null,null,-1),Q=Object(o["createVNode"])("span",null,"Trust me, it's private :/",-1),Z={class:"chat-box"},ee={class:"message-inner"},te={class:"username"},ne={class:"content"},oe=Object(o["createVNode"])("video",{id:"video_ele",autoplay:""},null,-1),ie={key:0},ce=Object(o["createVNode"])("input",{type:"submit",value:"Send"},null,-1),re={key:1};Object(o["popScopeId"])();var ae=X((function(e,t,n,i,c,r){return Object(o["openBlock"])(),Object(o["createBlock"])("div",Y,[Object(o["createVNode"])("header",null,[Object(o["createVNode"])("h1",null,[G,J,Q,Object(o["createVNode"])("button",{id:"back",onClick:t[1]||(t[1]=function(){return r.peerConn_exit&&r.peerConn_exit.apply(r,arguments)})},"Close")])]),Object(o["createVNode"])("section",Z,[(Object(o["openBlock"])(!0),Object(o["createBlock"])(o["Fragment"],null,Object(o["renderList"])(i.messages,(function(e){return Object(o["openBlock"])(),Object(o["createBlock"])("div",{key:e.key,class:e.username==n.state.username?"message current-user":"message"},[Object(o["createVNode"])("div",ee,[Object(o["createVNode"])("div",te,Object(o["toDisplayString"])(e.username),1),Object(o["createVNode"])("div",ne,Object(o["toDisplayString"])(e.content),1)])],2)})),128)),oe]),Object(o["createVNode"])("footer",null,[i.messages.length?(Object(o["openBlock"])(),Object(o["createBlock"])("div",ie,[Object(o["createVNode"])("button",{onClick:t[2]||(t[2]=function(){return r.video_call&&r.video_call.apply(r,arguments)}),id:"disconnect_call"},"Video Call"),Object(o["createVNode"])("form",{onSubmit:t[4]||(t[4]=Object(o["withModifiers"])((function(){return r.SendMessage&&r.SendMessage.apply(r,arguments)}),["prevent"]))},[Object(o["withDirectives"])(Object(o["createVNode"])("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=function(e){return c.inputMessage=e}),placeholder:"Write a message..."},null,512),[[o["vModelText"],c.inputMessage]]),ce],32)])):(Object(o["openBlock"])(),Object(o["createBlock"])("p",re,"Connecting..."))])])})),se=(n("1276"),n("ac1f"),{name:"peerconn",props:{state:{},peer_info:{}},methods:{SendMessage:function(){if(""!=this.inputMessage){var e={name:this.state.username,message:this.inputMessage},t=this.conn,n=this.messages;this.inputMessage="",this.$emit("peerConn_newMsg",{name:this.peer_info.name,len:n.length}),this.unsent()?(t=this.peer_info.me.connect(this.peer_info.id),n.push({username:e.name,content:e.message}),t.on("open",(function(){t.send(e)}))):(t.send(e),n.push({username:e.name,content:e.message})),this.conn=t,this.$emit("emit_to_branch",e)}},unsent:function(){for(var e=this.messages,t=this.state.username,n=0,o=0;o<e.length;o++)e[o].username==t&&n++;return!(n>1)},peerConn_exit:function(){this.$emit("peerConn_exit",this.peer_info.name)},video_call:function(){var e=this;document.getElementById("video_ele").srcObject?(this.vidConn.pop().close(),this.inputMessage="I have ended the video call.",this.SendMessage(),document.getElementById("video_ele").srcObject=void 0,document.getElementById("disconnect_call").innerHTML="Video Call"):navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(t){var n=e.peer_info.me.call(e.peer_info.id,t);e.vidConn.push(n),n.on("stream",e.renderVideo),n.on("close",(function(){document.getElementById("video_ele").srcObject=void 0})),e.inputMessage="I have initialised a video call. Allow video input to continue.",e.SendMessage(),document.getElementById("disconnect_call").innerHTML="Terminate Video Call"}))}},data:function(){return{inputMessage:""}},setup:function(e,t){var n=t.emit,i=Object(o["reactive"])(e.peer_info.me.connect(e.peer_info.id)),c=Object(o["reactive"])([]),r=Object(o["reactive"])([]),a=!1,s=function(e){document.getElementById("video_ele").srcObject=e};return i.on("open",(function(){i.send({name:e.state.username,message:"Hello. We are connected. Chat way."})})),e.peer_info.me.on("connection",(function(t){t.on("data",(function(t){n("peerConn_newMsg",{name:e.peer_info.name,len:r.length}),e.peer_info.name.split(", ").includes(t.name.split(",")[0])&&(r.push({username:t.name.split(",").pop(),content:t.message}),n("emit_to_branch",{name:t.name.split(",").pop(),message:t.message})),a||"Hello. We are connected. Chat way."!=t.message||(a=!0,i=e.peer_info.me.connect(e.peer_info.id),i.on("open",(function(){i.send({name:e.state.username,message:"Hi. We are connected. Chat way."})}))),"I have ended the video call."==t.message&&document.getElementById("video_ele").srcObject&&(c.pop().close(),document.getElementById("video_ele").srcObject=void 0,document.getElementById("disconnect_call").innerHTML="Video Call")}))})),e.peer_info.me.on("call",(function(e){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(t){c.push(e),e.answer(t),e.on("stream",s),document.getElementById("disconnect_call").innerHTML="Terminate Video Call"}))})),{conn:i,messages:r,renderVideo:s,vidConn:c}}});n("c6b0");se.render=ae,se.__scopeId="data-v-a36c8be4";var ue=se,le=Object(o["withScopeId"])("data-v-17d19d64"),de=le((function(e,t,n,i,c,r){return Object(o["openBlock"])(),Object(o["createBlock"])("div")})),pe={name:"peerconn",props:{state:{},peer_info:{}},methods:{SendMessage:function(){if(""!=this.inputMessage){var e={name:this.state.username,message:this.inputMessage},t=this.conn,n=this.messages;this.inputMessage="",this.$emit("peerConn_newMsg",{name:this.peer_info.name,len:n.length}),this.unsent()?(t=this.peer_info.me.connect(this.peer_info.id),n.push({username:e.name,content:e.message}),t.on("open",(function(){t.send(e)}))):(t.send(e),n.push({username:e.name,content:e.message})),this.conn=t}},unsent:function(){for(var e=this.messages,t=this.state.username,n=0,o=0;o<e.length;o++)e[o].username==t&&n++;return!(n>1)},peerConn_exit:function(){this.$emit("peerConn_exit",this.peer_info.name)},video_call:function(){var e=this;document.getElementById("video_ele").srcObject?(this.vidConn.pop().close(),this.inputMessage="I have ended the video call.",this.SendMessage(),document.getElementById("video_ele").srcObject=void 0,document.getElementById("disconnect_call").innerHTML="Video Call"):navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(t){var n=e.peer_info.me.call(e.peer_info.id,t);e.vidConn.push(n),n.on("stream",e.renderVideo),n.on("close",(function(){document.getElementById("video_ele").srcObject=void 0})),e.inputMessage="I have initialised a video call. Allow video input to continue.",e.SendMessage(),document.getElementById("disconnect_call").innerHTML="Terminate Video Call"}))}},data:function(){return{inputMessage:""}},setup:function(e,t){var n=t.emit,i=Object(o["reactive"])(e.peer_info.me.connect(e.peer_info.id)),c=Object(o["reactive"])([]),r=Object(o["reactive"])([]),a=!1,s=function(e){document.getElementById("video_ele").srcObject=e};return i.on("open",(function(){i.send({name:e.state.username,message:"Hello. We are connected. Chat way."})})),e.peer_info.me.on("connection",(function(t){t.on("data",(function(t){n("peerConn_newMsg",{name:e.peer_info.name,len:r.length}),t.name==e.peer_info.name&&(n("emit_to_group",[e.peer_info,{username:t.name,content:t.message}]),r.push({username:t.name,content:t.message})),a||"Hello. We are connected. Chat way."!=t.message||(a=!0,i=e.peer_info.me.connect(e.peer_info.id),i.on("open",(function(){i.send({name:e.state.username,message:"Hi. We are connected. Chat way."})}))),"I have ended the video call."==t.message&&document.getElementById("video_ele").srcObject&&(c.pop().close(),document.getElementById("video_ele").srcObject=void 0,document.getElementById("disconnect_call").innerHTML="Video Call")}))})),e.peer_info.me.on("call",(function(e){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(t){c.push(e),e.answer(t),e.on("stream",s),document.getElementById("disconnect_call").innerHTML="Terminate Video Call"}))})),{conn:i,messages:r,renderVideo:s,vidConn:c}}};n("dc12");pe.render=de,pe.__scopeId="data-v-17d19d64";var me=pe,fe={components:{peercomp:q,peerconn:ue,peerconnSec:me,Splitpanes:_["Splitpanes"],Pane:_["Pane"]},methods:{Logout:function(){var e=k.database().ref("messages"),t=k.database().ref("userlist"),n=e.orderByChild("username").equalTo(this.state.username).on("child_added",(function(t){e.child(t.key).remove()}));t.orderByChild("username").equalTo(this.state.username).once("child_added",(function(e){t.child(e.key).remove()})),e.orderByChild("username").equalTo(this.state.username).off("child_added",n),this.state.username="",this.peerMenu_exit();for(var o=0;o<this.active_peers.length;o++)this.peerConn_exit(this.active_peers[o].name)},peerMenu_open:function(){this.state.peer_on=!0,this.left_size=50},peerMenu_exit:function(){this.state.peer_on&&(this.state.peer_on=!1,this.left_size=0,this.mid_size>0&&(this.mid_size=65))},peerConn_open:function(e){this.left_size=0,this.mid_size=65;for(var t=0;t<this.active_peers.length;t++)if(this.active_peers[t].name==e.name)return void(this.active_peers[t].active=!0);this.active_peers.push(e)},peerConn_open_group:function(e){this.active_peers_group.push(e)},peerConn_exit:function(e){for(var t=0,n=0;n<this.active_peers.length;n++)this.active_peers[n].name==e&&(this.active_peers[n].active=!1),this.active_peers[n].active&&t++;0==t&&(this.mid_size=0);for(var o=this.$refs.peercomp_child_ref,i=0;i<o.active_peers.length;i++)o.active_peers[i].names.join(", ")},peerConn_newMsg:function(e){e.len>9&&setTimeout((function(){document.getElementById(e.name).scroll(0,document.getElementById(e.name).scrollHeight)}),10)},emit_to_group:function(e){var t=e[1],n=e[0].sender_name[0];console.log(t),console.log(n),this.$refs[n].conn.send({name:this.state.username+","+t.username,message:t.content}),this.$refs[n].messages.push(t)},emit_to_branch:function(e){console.log(this.$refs["sec"]),this.$refs["sec"]&&(console.log(e),this.$refs["sec"].conn.send({name:this.state.username+","+e.name,message:e.message}))}},data:function(){return{active_peers:[],active_peers_group:[],left_size:0,mid_size:0}},setup:function(){var e=Object(o["ref"])(""),t=Object(o["ref"])(""),n=Object(o["reactive"])({username:"",messages:[],userlist:[]}),i=function(){if(""!=e.value||null!=e.value){var t=k.database().ref("userlist");t.orderByChild("username").equalTo(e.value).once("value",(function(o){if(o.exists())alert("exists!");else{n.username=e.value;var i={username:n.username};t.push(i),e.value=""}}))}},c=function(){var e=k.database().ref("messages");if(""!==t.value&&null!==t.value){var o={username:n.username,content:t.value};e.push(o),t.value="",setTimeout((function(){document.getElementById("right").scroll(0,document.getElementById("right").scrollHeight)}),10)}};return Object(o["onMounted"])((function(){var e=k.database().ref("messages"),t=k.database().ref("userlist");e.on("value",(function(e){var t=e.val(),o=[];t&&(Object.keys(t).forEach((function(e){o.push({id:e,username:t[e].username,content:t[e].content})})),n.messages=o,setTimeout((function(){document.getElementById("right").scroll(0,document.getElementById("right").scrollHeight)}),10))})),t.on("value",(function(e){var t=e.val(),o=[];t&&(Object.keys(t).forEach((function(e){o.push({username:t[e].username})})),n.userlist=o)}))})),{inputUsername:e,Login:i,state:n,inputMessage:t,SendMessage:c}}};n("82cf");fe.render=v;var he=fe;Object(o["createApp"])(he).mount("#app")},"5e11":function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="5e11"},"82cf":function(e,t,n){"use strict";n("a7ab")},a7ab:function(e,t,n){},c6b0:function(e,t,n){"use strict";n("4473")},dc12:function(e,t,n){"use strict";n("5356")},dd8b:function(e,t,n){}});
//# sourceMappingURL=app.d0c93f85.js.map